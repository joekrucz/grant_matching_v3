{% extends 'base.html' %}

{% block title %}Add Company - Grants Aggregator{% endblock %}

{% block content %}
<div class="hero min-h-[80vh]">
    <div class="hero-content">
        <div class="card bg-base-200 w-full max-w-2xl shadow-xl">
            <div class="card-body">
                <h1 class="card-title text-3xl justify-center mb-4">Add Company</h1>
                
                <!-- Mode Selection Tabs -->
                <div class="tabs tabs-boxed mb-6">
                    <a class="tab tab-active" onclick="switchMode('registered')" id="tab-registered">Companies House Lookup</a>
                    <a class="tab" onclick="switchMode('manual')" id="tab-manual">Manual Entry (Unregistered)</a>
                </div>
                
                <!-- Companies House Lookup Form -->
                <form method="post" action="{% url 'companies:create' %}" id="form-registered">
                    {% csrf_token %}
                    <input type="hidden" name="creation_mode" value="registered">
                    
                    <div class="form-control">
                        <label class="label" for="id_company_number">
                            <span class="label-text">Companies House Number</span>
                        </label>
                        <input 
                            type="text" 
                            name="company_number" 
                            id="id_company_number" 
                            required 
                            placeholder="e.g., 12345678"
                            class="input input-bordered"
                        >
                        <label class="label">
                            <span class="label-text-alt">Enter a Companies House company number to fetch company details automatically.</span>
                        </label>
                    </div>
                    
                    <div class="form-control mt-6">
                        <button type="submit" class="btn btn-primary">Fetch Company</button>
                    </div>
                </form>
                
                <!-- Manual Entry Form -->
                <form method="post" action="{% url 'companies:create' %}" id="form-manual" style="display: none;">
                    {% csrf_token %}
                    <input type="hidden" name="creation_mode" value="manual">
                    
                    <div class="form-control mb-4">
                        <label class="label" for="id_name">
                            <span class="label-text">Company Name <span class="text-error">*</span></span>
                        </label>
                        <input 
                            type="text" 
                            name="name" 
                            id="id_name" 
                            required 
                            placeholder="e.g., My Startup Ltd"
                            class="input input-bordered"
                        >
                    </div>
                    
                    <div class="form-control mb-4">
                        <label class="label" for="id_company_type">
                            <span class="label-text">Company Type</span>
                        </label>
                        <select name="company_type" id="id_company_type" class="select select-bordered">
                            <option value="">Select type...</option>
                            <option value="Startup">Startup</option>
                            <option value="Sole Trader">Sole Trader</option>
                            <option value="Partnership">Partnership</option>
                            <option value="Limited Company">Limited Company</option>
                            <option value="LLC">LLC</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-control mb-4">
                        <label class="label" for="id_website">
                            <span class="label-text">Website</span>
                        </label>
                        <input 
                            type="url" 
                            name="website" 
                            id="id_website" 
                            placeholder="https://example.com"
                            class="input input-bordered"
                        >
                    </div>
                    
                    <div class="divider">Address (Optional)</div>
                    
                    <div class="form-control mb-4">
                        <label class="label" for="id_address_line_1">
                            <span class="label-text">Address Line 1</span>
                        </label>
                        <input 
                            type="text" 
                            name="address_line_1" 
                            id="id_address_line_1" 
                            placeholder="Street address"
                            class="input input-bordered"
                        >
                    </div>
                    
                    <div class="form-control mb-4">
                        <label class="label" for="id_address_line_2">
                            <span class="label-text">Address Line 2</span>
                        </label>
                        <input 
                            type="text" 
                            name="address_line_2" 
                            id="id_address_line_2" 
                            placeholder="Apartment, suite, etc."
                            class="input input-bordered"
                        >
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="form-control">
                            <label class="label" for="id_locality">
                                <span class="label-text">City/Town</span>
                            </label>
                            <input 
                                type="text" 
                                name="locality" 
                                id="id_locality" 
                                placeholder="City"
                                class="input input-bordered"
                            >
                        </div>
                        
                        <div class="form-control">
                            <label class="label" for="id_postal_code">
                                <span class="label-text">Postal Code</span>
                            </label>
                            <input 
                                type="text" 
                                name="postal_code" 
                                id="id_postal_code" 
                                placeholder="Postcode"
                                class="input input-bordered"
                            >
                        </div>
                    </div>
                    
                    <div class="form-control mb-4">
                        <label class="label" for="id_country">
                            <span class="label-text">Country</span>
                        </label>
                        <input 
                            type="text" 
                            name="country" 
                            id="id_country" 
                            placeholder="Country"
                            class="input input-bordered"
                        >
                    </div>
                    
                    <div class="form-control mb-4">
                        <label class="label" for="id_notes">
                            <span class="label-text">Notes</span>
                        </label>
                        <textarea 
                            name="notes" 
                            id="id_notes" 
                            placeholder="Additional notes about the company..."
                            class="textarea textarea-bordered"
                            rows="3"
                        ></textarea>
                    </div>
                    
                    <div class="form-control mt-6">
                        <button type="submit" class="btn btn-primary">Create Company</button>
                    </div>
                </form>
                
                <div class="text-center mt-4">
                    <a href="{% url 'companies:list' %}" class="link link-primary">Back to Companies</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function switchMode(mode) {
    const registeredForm = document.getElementById('form-registered');
    const manualForm = document.getElementById('form-manual');
    const registeredTab = document.getElementById('tab-registered');
    const manualTab = document.getElementById('tab-manual');
    
    if (mode === 'registered') {
        registeredForm.style.display = 'block';
        manualForm.style.display = 'none';
        registeredTab.classList.add('tab-active');
        manualTab.classList.remove('tab-active');
    } else {
        registeredForm.style.display = 'none';
        manualForm.style.display = 'block';
        registeredTab.classList.remove('tab-active');
        manualTab.classList.add('tab-active');
    }
}
</script>
{% endblock %}
